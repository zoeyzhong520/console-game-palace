{"version":3,"sources":["uni-app:///pages_recommend/recommend_search/cgp_recommend_search.js","uni-app:///pages_recommend/recommend_detail/cgp_recommend_detail.js"],"names":["fuzzyQuery","list","keyWord","uni","showLoading","reg","RegExp","arr","i","length","test","title","push","hideLoading","recommend_search_all_data","Bmob","page","Promise","resolve","reject","query","Query","limit","skip","find","then","res","getSearchHistory","getStorageSync","slice","saveSearchHistory","keyword","searchHistory","indexOf","unshift","setStorageSync","recommend_detail_getRecord_with_objectId","objectId","mask","get","catch","err","recommend_detail_editRecord_with_objectId","set","readCount","save"],"mappings":"mRAMO,IAAMA,EAAa,SAASC,EAAMC,GACxCC,EAAIC,cAGJ,IAFA,IAAIC,EAAM,IAAIC,OAAOJ,GACjBK,EAAM,GACDC,EAAI,EAAGA,EAAIP,EAAKQ,OAAQD,IAC5BH,EAAIK,KAAKT,EAAKO,GAAGG,QACpBJ,EAAIK,KAAKX,EAAKO,IAIhB,OADAL,EAAIU,cACGN,G,eAKD,IAAMO,EAA4B,SAASC,EAAMC,GACvD,OAAO,IAAIC,SAAQ,SAACC,EAASC,GAE5B,IAAMC,EAAQL,EAAKM,MAAM,oBACzBD,EAAME,MAAM,KACZF,EAAMG,KAAY,IAAPP,GACXI,EAAMI,OAAOC,MAAK,SAAAC,GACjBR,EAAQQ,U,8BASJ,IAAMC,EAAmB,WAC/B,OAASxB,EAAIyB,eAAe,qBAAuBzB,EAAIyB,eAAe,qBAAqBC,MAAM,EAAE,IAAM,I,qBAOnG,IAAMC,EAAoB,SAASC,GACzC,IAAMC,EAAgBL,IAChBK,IAAoD,GAAnCA,EAAcC,QAAQF,IAAkBA,EAAQtB,OAAS,IAC/EuB,EAAcE,QAAQH,GAEtB5B,EAAIgC,eAAe,oBAAqBH,K,gPChDnC,IAAMI,EAA2C,SAASrB,EAAMsB,GACtE,OAAO,IAAIpB,SAAQ,SAACC,EAASC,GAE5BhB,EAAIC,YAAY,CACfkC,MAAM,IAGP,IAAMlB,EAAQL,EAAKM,MAAM,iBACzBD,EAAMmB,IAAIF,GAAUZ,MAAK,SAAAC,GACxBvB,EAAIU,cACJK,EAAQQ,MACNc,OAAM,SAAAC,GACRtC,EAAIU,cACJM,EAAOsB,U,6CAQH,IAAMC,EAA4C,SAAS3B,EAAMsB,GACvE,OAAO,IAAIpB,SAAQ,SAACC,EAASC,GAE5B,IAAMC,EAAQL,EAAKM,MAAM,oBACzBD,EAAMmB,IAAIF,GAAUZ,MAAK,SAAAC,GAExBA,EAAIiB,IAAI,aAAiBjB,EAAIkB,UAAgBlB,EAAIkB,UAAR,GAAmB,GAC5DlB,EAAImB,OAAOpB,MAAK,SAAAC,GAEfR,EAAQQ,MACNc,OAAM,SAAAC,GACRtB,EAAOsB,SAEND,OAAM,SAAAC,GACRtB,EAAOsB,U","file":"pages_recommend/common/vendor.js","sourcesContent":["/**\n * 使用test方法实现模糊查询\n * @param  {Array}  list     原数组\n * @param  {String} keyWord  查询的关键词\n * @return {Array}           查询的结果\n */\nexport const fuzzyQuery = function(list, keyWord) {\n\tuni.showLoading()\n\tvar reg = new RegExp(keyWord);\n\tvar arr = [];\n\tfor (var i = 0; i < list.length; i++) {\n\t\tif (reg.test(list[i].title)) {\n\t\t\tarr.push(list[i]);\n\t\t}\n\t}\n\tuni.hideLoading()\n\treturn arr;\n}\n\n// 获取全部数据\n// page 请求的分页页码\nexport const recommend_search_all_data = function(Bmob, page) {\n\treturn new Promise((resolve, reject) => {\n\t\t\n\t\tconst query = Bmob.Query('CGP_HotRecommend')\n\t\tquery.limit(100)\n\t\tquery.skip(page * 100)\n\t\tquery.find().then(res => {\n\t\t\tresolve(res)\n\t\t});\n\t\t\n\t})\n}\n\n/**\n * @description 获取本地缓存的搜索记录\n */ \nexport const getSearchHistory = function() {\n\treturn !!uni.getStorageSync('searchKeywordsKey') ? uni.getStorageSync('searchKeywordsKey').slice(0,19) : []\n}\n\n/**\n * @description 把搜索的关键词保存到本地\n * @param {String} keyword \n */ \nexport const saveSearchHistory = function(keyword) {\n\tconst searchHistory = getSearchHistory()\n\tif (!!searchHistory && searchHistory.indexOf(keyword) == -1 && keyword.length > 0) {\n\t\tsearchHistory.unshift(keyword) // 插入到数组头部\n\t\t// 搜索记录缓存到本地\n\t\tuni.setStorageSync('searchKeywordsKey', searchHistory)\n\t}\n}\n\n","// 通过主键获取一行记录\n// objectId 主键\nexport const recommend_detail_getRecord_with_objectId = function(Bmob, objectId) {\n\treturn new Promise((resolve, reject) => {\n\n\t\tuni.showLoading({\n\t\t\tmask: false\n\t\t})\n\n\t\tconst query = Bmob.Query('CGP_DeviceIds');\n\t\tquery.get(objectId).then(res => {\n\t\t\tuni.hideLoading()\n\t\t\tresolve(res)\n\t\t}).catch(err => {\n\t\t\tuni.hideLoading()\n\t\t\treject(err)\n\t\t})\n\n\t})\n}\n\n// 通过主键修改一行记录\n// objectId 主键\nexport const recommend_detail_editRecord_with_objectId = function(Bmob, objectId) {\n\treturn new Promise((resolve, reject) => {\n\n\t\tconst query = Bmob.Query('CGP_HotRecommend');\n\t\tquery.get(objectId).then(res => {\t\n\t\t\t// 每次打开游戏详情页，给readCount增加1\n\t\t\tres.set('readCount', (!!!res.readCount ? 0 : res.readCount)+1)\n\t\t\tres.save().then(res => {\n\t\t\t\t// console.log(res)\n\t\t\t\tresolve(res)\n\t\t\t}).catch(err => {\n\t\t\t\treject(err)\n\t\t\t})\n\t\t}).catch(err => {\n\t\t\treject(err)\n\t\t})\n\n\t})\n}\n"],"sourceRoot":""}